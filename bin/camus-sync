#!/usr/bin/env ruby

ROOT = File.expand_path('../..', __FILE__)

require 'bundler/setup'
require 'liquid/boot'
require 'camus-sync/cli'

CLI.for(CamusSync::CLI) do
  option :window,
    :short => '-w HOURS',
    :long => '--window HOURS',
    :description => 'scan window in hours, defaults to 24 hours',
    :default => 24,
    :proc => Proc.new { |x| x.to_i }

  option :offset,
    :short => '-f HOURS',
    :long => '--offset HOURS',
    :description => 'offset from now used as interval end, defaults to 3 hours',
    :default => 3,
    :proc => Proc.new { |x| x.to_i }

  option :topics,
    :short => '-t LIST',
    :long => '--topics LIST',
    :description => 'Topics to process (comma seperated)',
    :default => [],
    :proc => Proc.new { |x| x.split(',') }

  option :namenodes,
    :short => '-n LIST',
    :long => '--namenodes LIST',
    :description => 'HDFS namenodes (comma seperated), defaults to "localhost"',
    :default => %w(localhost),
    :proc => Proc.new { |x| x.split(',') }

  option :camus_path,
    :short => '-c PATH',
    :long => '--camus-path PATH',
    :description => 'HDFS path where camus saves its data'

  option :dryrun,
    :short => '-N',
    :long => '--dryrun',
    :description => 'do not submit tasks to overlord (dry-run)'
end.run

# vim: et ts=2 sw=2
